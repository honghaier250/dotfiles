-----------------------------------------------------------------------------------------
                                    start oprofile
-----------------------------------------------------------------------------------------
modprobe oprofile timer=1 

# 是否对kernel进行profiling
opcontrol --no-vmlinux
opcontrol --separate=kernel
opcontrol --vmlinux=/boot/vmlinux-`uname -r`

# 加载模块
opcontrol --init

# 清除当前会话中的数据
opcontrol --reset

# 开始profiling
opcontrol --start

-----------------------------------------------------------------------------------------
                                    run program
-----------------------------------------------------------------------------------------
./program

-----------------------------------------------------------------------------------------
                                    stop oprofile
-----------------------------------------------------------------------------------------
# 把收集到的数据写入文件 
opcontrol --dump

# 停止profiling
opcontrol --stop

# 关闭守护进程
opcontrol --shutdown

# 卸载模块
opcontrol --deinit


-----------------------------------------------------------------------------------------
                                    statistics oprofile
-----------------------------------------------------------------------------------------
opreport : 以镜像(image)的角度显示检测结果，进程、动态库、内核模块属于镜像范畴

# 以函数的角度显示检测结果
opreport -l
opreport -l program

# 以代码的角度，针对test进程显示检测结果
opannotate --source program --base-dirs=XXX --search-dirs=XXX --output-dir=./tmp/ *.so
opannotate -s /lib64/libc-2.4.so

